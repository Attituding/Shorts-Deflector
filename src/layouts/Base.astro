---
import '../styles/base.css';
import Link from '../components/Link.astro';
import Content from './Content.astro';
import Footer from './Footer.astro';
import Header from './Header.astro';

export interface Props {
    title?: string;
}

const { title } = Astro.props as Props;

const site = 'Shorts Deflector';

const titleMeta = title ? `${title} - ${site}` : site;
---

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta content="width=device-width" name="viewport" />
        <meta content={Astro.generator} name="generator" />

        <link href="/icon.svg" rel="icon" type="image/svg+xml" />
        <link href="/icon.webp" rel="shortcut icon" type="image/x-icon" />
        
        <!-- General Meta Tags -->
        <title>{titleMeta}</title>
        <meta content="Watch YouTube Shorts with the normal desktop interface" name="description" />
        <meta content="#f40407" name="theme-color" />

        <!-- Open Graph -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://attituding.live/" />
        <meta property="og:title" content={titleMeta} />
        <meta
            property="og:description"
            content="Watch YouTube Shorts with the normal desktop interface"
        />
        <meta property="og:image" content="/icon.webp" />

        <!-- Twitter -->
        <meta property="twitter:title" content={titleMeta} />
        <meta
            content="Watch YouTube Shorts with the normal desktop interface"
            property="twitter:description"
        />
        <meta property="twitter:image" content="/icon.webp" />
    </head>
    <body class="flex flex-col dark:bg-dark-1 bg-light-1 font-sans text-light-1 dark:text-dark-1">
        <Header title={site}>
            <Link
                href="https://chrome.google.com/webstore/detail/shorts-deflector/gilmponliddppjjcfjmanmmfgiilikhg"
                label="Chromium"
            />
            <Link
                href="https://addons.mozilla.org/firefox/addon/shorts-deflector/"
                label="Firefox"
            />
            <Link href="https://github.com/Attituding/shorts-deflector" label="GitHub" />
            <Link href="/privacy" label="Privacy" />
        </Header>
        <Content>
            <slot />
        </Content>
        <Footer author="Attituding" authorHref="https://attituding.live" />
        <script>
            // Anchor stuff
            const anchors = document.querySelectorAll<HTMLAnchorElement>('a[href^="#"]');
            const header = document.getElementById('header') as HTMLDivElement;

            const scrollToAnchor = (anchor: HTMLAnchorElement) => {
                const top =
                    anchor.getBoundingClientRect().top + window.pageYOffset - header.offsetHeight;

                window.scrollTo({
                    top: top,
                    behavior: 'smooth',
                });
            };

            anchors.forEach((anchor) => {
                anchor.addEventListener('click', () => {
                    scrollToAnchor(anchor);
                });
            });

            const selectedAnchor = Object.values(anchors).find(
                (anchor) => anchor.href === document.URL,
            );

            if (selectedAnchor) {
                scrollToAnchor(selectedAnchor);
            }
        </script>
    </body>
</html>
